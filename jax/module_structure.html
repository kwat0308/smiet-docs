


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="jax_index.html">
      
      
        <link rel="next" href="difference_with_numpy.html">
      
      
      <link rel="icon" href="">
    
    
      
        <title>Module structure - SMIET 0.7 documentation</title>
      
    
    
      
        
      
      


    
    
      
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../_static/sphinx_immaterial_theme.acf80fe7f4d9ef9e2.min.css?v=9e56d0d2" />
        <link rel="stylesheet" type="text/css" href="/_static/sphinx_immaterial_theme.acf80fe7f4d9ef9e2.min.css" />
        <link rel="stylesheet" type="text/css" href="/_static/basic.css" />
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-green" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#reading-in-showers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="SMIET 0.7 documentation" class="md-header__button md-logo" aria-label="SMIET 0.7 documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SMIET 0.7 documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Module structure
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="light-green" data-md-color-accent="light-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="SMIET 0.7 documentation" class="md-nav__button md-logo" aria-label="SMIET 0.7 documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>
    </a>
    SMIET 0.7 documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    <span>Sections in this documentation:<wbr></span>
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            <span>Sections in this documentation:<wbr></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../logging.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span>How to use logging in this package</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../conventions_units.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span>Conventions in this package</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../minimal_example.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span>Minimal Example</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../template-synthesis/ts_index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span>A User’s Guide to Template Synthesis</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../numpy/numpy_index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span>Num<wbr>Py module</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="jax_index.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span>JAX module</span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1_6" id="__nav_1_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_6">
            <span class="md-nav__icon md-icon"></span>
            <span>JAX module</span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    <span>Module structure</span>
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    <span>Module structure</span>
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#reading-in-showers" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span>Reading in showers</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reading in showers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#baseshower" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span>Base<wbr>Shower</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slicedshower" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span>Sliced<wbr>Shower</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SlicedShower">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialisation" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span>Initialisation</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-shower-properties" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span>Accessing shower properties</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coreasshower" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span>Coreas<wbr>Shower</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CoreasShower">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#id1" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span>Initialisation</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id2" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span>Accessing shower properties</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#making-a-template" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span>Making a Template</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mapping-the-template" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span>Mapping the template</span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="difference_with_numpy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span>Key Differences with Num<wbr>Py version</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="package_documentation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span>Package documentation</span>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../corsika/corsika_index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span>Tools for CORSIKA/Co<wbr>REAS</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span>Release notes</span>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#reading-in-showers" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span>Reading in showers</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reading in showers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#baseshower" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span>Base<wbr>Shower</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slicedshower" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span>Sliced<wbr>Shower</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SlicedShower">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialisation" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span>Initialisation</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#accessing-shower-properties" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span>Accessing shower properties</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coreasshower" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span>Coreas<wbr>Shower</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CoreasShower">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#id1" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span>Initialisation</span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id2" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span>Accessing shower properties</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#making-a-template" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span>Making a Template</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mapping-the-template" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span>Mapping the template</span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                
                
                  


<h1 id="module-structure">Module structure<a class="headerlink" href="#module-structure" title="Link to this heading">¶</a></h1>
<p>The main module of the JAX version of template synthesis (unlike the NumPy Version) only consists of the <code class="docutils literal notranslate"><span class="pre">TemplateSynthesis</span></code> class.</p>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>All arrays are defined through <code class="docutils literal notranslate"><span class="pre">jax.numpy</span></code>, which has almost identical API as the usual <code class="docutils literal notranslate"><span class="pre">numpy</span></code>. There are some differences, which you can find in <a class="reference external" href="https://docs.jax.dev/en/latest/jax.numpy.html">JAX NumPy documentation</a>.</p>
<p>To import <code class="docutils literal notranslate"><span class="pre">jax.numpy</span></code>, use the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
</code></pre></div>
</div>
<p>and now you can use <code class="docutils literal notranslate"><span class="pre">jnp</span></code> instead of <code class="docutils literal notranslate"><span class="pre">np</span></code> in your code.</p>
</div>
<h2 id="reading-in-showers">Reading in showers<a class="headerlink" href="#reading-in-showers" title="Link to this heading">¶</a></h2>
<p>There are two main modules in which one can use to read in showers:</p>
<h3 id="baseshower">BaseShower<a class="headerlink" href="#baseshower" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">BaseShower</span></code> class is the abstract base class for all shower readers. It provides the basic functionality to read in showers and access their properties. This class is not meant to be used directly, but rather as a base class for other shower readers.</p>
<p>There are a few parameters that need to be set, which are incidentally used in the <code class="docutils literal notranslate"><span class="pre">TemplateSynthesis</span></code> class. These parameters are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">xmax</span></code>: The maximum depth of the shower in g/cm^2.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nmax</span></code>: The maximum number of particles in the shower.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">zenith</span></code>: The zenith angle of the shower in radians.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">azimuth</span></code>: The azimuth angle of the shower in radians.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">magnet</span></code>: The magnetic field vector of the observation site in the NuRadioReco unit convention.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">core</span></code>: The core position of the shower in the NuRadioReco unit convention.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">smiet.jax.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseShower</span> <span class="k">as</span> <span class="n">Shower</span>

<span class="c1"># define atmospheric slices</span>
<span class="n">atm_slices</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1110</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="c1"># define parameters to set</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
<span class="s2">&quot;xmax&quot;</span> <span class="p">:</span> <span class="mi">800</span><span class="p">,</span>
<span class="s2">&quot;nmax&quot;</span> <span class="p">:</span> <span class="mf">1e9</span><span class="p">,</span>
<span class="s2">&quot;zenith&quot;</span> <span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="s2">&quot;azimuth&quot;</span> <span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="s2">&quot;magnet&quot;</span> <span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]),</span>
<span class="s2">&quot;core&quot;</span> <span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span>
<span class="p">}</span>

<span class="n">shower</span> <span class="o">=</span> <span class="n">Shower</span><span class="p">()</span>
<span class="n">shower</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">atm_slices</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>

<span class="c1"># to set the longitudinal profile, need to</span>
<span class="c1"># define it separately</span>
<span class="n">long_profile</span> <span class="o">=</span> <span class="n">some_longitudinal_profile_function</span><span class="p">(</span><span class="n">atm_slices</span><span class="p">)</span>
<span class="n">shower</span><span class="o">.</span><span class="n">set_longitudinal_profile</span><span class="p">(</span><span class="n">long_profile</span><span class="p">)</span>
</code></pre></div>
</div>
<h3 id="slicedshower">SlicedShower<a class="headerlink" href="#slicedshower" title="Link to this heading">¶</a></h3>
<p>This inherited class is used to read in showers that are sliced into atmospheric slices. This, similar to the <code class="docutils literal notranslate"><span class="pre">SlicedShower</span></code> class in the NumPy version, allows the reader to generate origin showers which are used to generate the template.</p>
<p>To initialise the <code class="docutils literal notranslate"><span class="pre">SlicedShower</span></code> class, a pre-simulated CoREAS simulation generated from <a class="reference internal" href="../corsika/corsika_index.html#corsika-filegeneration"><span class="std std-ref">Tools for CORSIKA/CoREAS</span></a> is required. To initialise the shower, the following command can be used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">smiet.jax.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">SlicedShower</span>

<span class="n">sliced_shower</span> <span class="o">=</span> <span class="n">SlicedShower</span><span class="p">(</span>
    <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;path/to/simulation/file&quot;</span><span class="p">,</span>
    <span class="n">gdas_file</span><span class="o">=</span><span class="s2">&quot;path/to/gdas/file&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
</div>
<p>Where the GDAS atmospheric file can optionally be passed as an additional argument for a more realistic atmospheric model.</p>
<h4 id="initialisation">Initialisation<a class="headerlink" href="#initialisation" title="Link to this heading">¶</a></h4>
<p>Initialising the <code class="docutils literal notranslate"><span class="pre">SlicedShower</span></code> object does the following:</p>
<ol class="arabic simple">
<li><p>Reads in the CoREAS simulation file and extracts the relevant information (e.g. the shower profile, the electric field, etc.).</p></li>
<li><p>Reads in the GDAS file (if provided) or a standard US atmospheric model into the <code class="docutils literal notranslate"><span class="pre">Atmosphere</span></code> object in <code class="docutils literal notranslate"><span class="pre">jax_radio_tools</span></code>.</p></li>
<li><p>Convert all relevant properties into standard NuRadioReco units, which is the convention used in this code. Here, a transformer <code class="docutils literal notranslate"><span class="pre">self.transformer</span></code> is defined based on the geometry and magnetic field of the shower.</p></li>
<li><p>Sort all antennas based on increasing radius and azimuth (in that order). This is done to consistently match antennas defined in the origin shower with those defined through other means (e.g. from standard CoREAS simulations).</p></li>
</ol>
<p>The resulting electric field traces for all antennas, positions, and slices can be accessed via the <code class="docutils literal notranslate"><span class="pre">self.get_traces_geoce</span></code> method.</p>
<p>By default, the traces are bandpass filtered between 30-500 MHz.</p>
<h4 id="accessing-shower-properties">Accessing shower properties<a class="headerlink" href="#accessing-shower-properties" title="Link to this heading">¶</a></h4>
<p>The following properties of the shower can be accessed, which can be useful in different scenarios:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># electric field traces in geomagnetic &amp; CR emission</span>
<span class="n">traces_geoce</span> <span class="o">=</span> <span class="n">sliced_shower</span><span class="o">.</span><span class="n">get_traces_geoce</span><span class="p">()</span>

<span class="c1"># time axis of the electric field traces</span>
<span class="n">trace_times</span> <span class="o">=</span> <span class="n">sliced_shower</span><span class="o">.</span><span class="n">trace_times</span>

<span class="c1"># antenna positions in ground plane</span>
<span class="n">ant_positions_ground</span> <span class="o">=</span> <span class="n">sliced_shower</span><span class="o">.</span><span class="n">antenna_array</span><span class="p">[</span><span class="s1">&#39;position&#39;</span><span class="p">]</span>

<span class="c1"># antenna positions in shower plane</span>
<span class="n">ant_positions_shower</span> <span class="o">=</span> <span class="n">sliced_shower</span><span class="o">.</span><span class="n">get_antennas_showerplane</span><span class="p">()</span>

<span class="c1"># distance of each antenna to the shower core</span>
<span class="n">ant_distances</span> <span class="o">=</span> <span class="n">sliced_shower</span><span class="o">.</span><span class="n">antenna_array</span><span class="p">[</span><span class="s1">&#39;dis_to_core&#39;</span><span class="p">]</span>
</code></pre></div>
</div>
<p>In addition, all properties as defined in the <code class="docutils literal notranslate"><span class="pre">BaseShower</span></code> class can be accessed. This includes the zenith and azimuth angles, the core position, the magnetic field vector, the maximum depth of the shower, and the longitudinal profile itself.</p>
<h3 id="coreasshower">CoreasShower<a class="headerlink" href="#coreasshower" title="Link to this heading">¶</a></h3>
<p>This is the main reader for CoREAS simulations, as it is the most common format used in the community. The <code class="docutils literal notranslate"><span class="pre">CoreasShower</span></code> class is a subclass of the <code class="docutils literal notranslate"><span class="pre">BaseShower</span></code> class and provides similar functionality as the <code class="docutils literal notranslate"><span class="pre">SlicedShower</span></code> class.</p>
<p>To initialise the <code class="docutils literal notranslate"><span class="pre">CoreasShower</span></code> class, a pre-simulated CoREAS simulation generated from <a class="reference internal" href="../corsika/corsika_index.html#corsika-filegeneration"><span class="std std-ref">Tools for CORSIKA/CoREAS</span></a> is required. To initialise the shower, the following command can be used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">smiet.jax.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">CoreasShower</span>

<span class="n">coreas_shower</span> <span class="o">=</span> <span class="n">CoreasShower</span><span class="p">(</span>
    <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;path/to/simulation/file&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
</div>
<h4 id="id1">Initialisation<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h4>
<p>Initialising the <code class="docutils literal notranslate"><span class="pre">CoreasShower</span></code> object does the following:</p>
<ol class="arabic simple">
<li><p>Reads in the CoREAS simulation file and extracts the relevant information (e.g. the shower profile, the electric field, etc.).</p></li>
<li><p>Convert all relevant properties into standard NuRadioReco units, which is the convention used in this code. Here, a transformer <code class="docutils literal notranslate"><span class="pre">self.transformer</span></code> is defined based on the geometry and magnetic field of the shower.</p></li>
<li><p>Sort all antennas based on increasing radius and azimuth (in that order). This is done to consistently match antennas defined in the origin shower with those defined through other means (e.g. from standard CoREAS simulations).</p></li>
</ol>
<h4 id="id2">Accessing shower properties<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h4>
<p>Most properties follow those from the <code class="docutils literal notranslate"><span class="pre">SlicedShower</span></code> class.</p>
<h2 id="making-a-template">Making a Template<a class="headerlink" href="#making-a-template" title="Link to this heading">¶</a></h2>
<p>We are finally ready to make a template. The <code class="docutils literal notranslate"><span class="pre">TemplateSynthesis</span></code> class is the main class to use for this. It takes a <code class="docutils literal notranslate"><span class="pre">BaseShower</span></code> object as input and generates a template based on the shower properties.</p>
<p>The template is generated by using the <code class="docutils literal notranslate"><span class="pre">make_template</span></code> method, which takes a <code class="docutils literal notranslate"><span class="pre">SlicedShower</span></code> object to generate a template. This template can be stored as a HDF5 file using the <code class="docutils literal notranslate"><span class="pre">save_template</span></code> method. The template can be loaded again using the <code class="docutils literal notranslate"><span class="pre">load_template</span></code> method.</p>
<p>Example to generate a template for a given shower within a frequency bandwidth of 30-80 MHz with a timing resolution of 2 ns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">smiet.jax</span><span class="w"> </span><span class="kn">import</span> <span class="n">TemplateSynthesis</span><span class="p">,</span> <span class="n">SlicedShower</span>

<span class="c1"># create a template object</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">TemplateSynthesis</span><span class="p">(</span>
    <span class="n">freq_ar</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">MHz</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># initialise the sliced shower</span>
<span class="n">sliced_shower</span> <span class="o">=</span> <span class="n">SlicedShower</span><span class="p">(</span>
    <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;path/to/simulation/file&quot;</span><span class="p">,</span>
    <span class="n">gdas_file</span><span class="o">=</span><span class="s2">&quot;path/to/gdas/file&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="c1"># apply cuts</span>
<span class="n">sliced_shower</span><span class="o">.</span><span class="n">apply_trace_cuts</span><span class="p">(</span>
    <span class="n">f_min</span><span class="o">=</span><span class="mi">30</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">MHz</span><span class="p">,</span>
    <span class="n">f_max</span><span class="o">=</span><span class="mi">80</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">MHz</span><span class="p">,</span>
    <span class="n">delta_t</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">ns</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># make the template</span>
<span class="n">template</span><span class="o">.</span><span class="n">make_template</span><span class="p">(</span><span class="n">sliced_shower</span><span class="p">)</span>

<span class="c1"># save the template</span>
<span class="n">template</span><span class="o">.</span><span class="n">save_template</span><span class="p">(</span><span class="s2">&quot;some_template.hdf5&quot;</span><span class="p">)</span>

<span class="c1"># load the template</span>
<span class="n">new_template</span> <span class="o">=</span> <span class="n">TemplateSynthesis</span><span class="p">(</span>
    <span class="n">freq_ar</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">MHz</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">new_template</span><span class="o">.</span><span class="n">load_template</span><span class="p">(</span><span class="s2">&quot;some_template.hdf5&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
<h2 id="mapping-the-template">Mapping the template<a class="headerlink" href="#mapping-the-template" title="Link to this heading">¶</a></h2>
<p>The generated template can be used to synthesise the electric field traces for all given antenna positions,
given any shower defined (and inherited from) the <code class="docutils literal notranslate"><span class="pre">BaseShower</span></code> class.</p>
<div class="note admonition">
<p class="admonition-title">Note</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">CoreasShower</span></code> showers, it is important to map the grammage steps (and therefore the
longitudinal profile) to those from the origin shower, as the grammage steps may not be the same in the
CoREAS simulation. This can be done by using the <code class="docutils literal notranslate"><span class="pre">transform_profile_to_origin</span></code> method of the
<code class="docutils literal notranslate"><span class="pre">CoreasShower</span></code> class.</p>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">smiet.jax</span><span class="w"> </span><span class="kn">import</span> <span class="n">TemplateSynthesis</span><span class="p">,</span> <span class="n">Shower</span><span class="p">,</span> <span class="n">CoREASHDF5</span>

<span class="c1"># create a template object</span>
<span class="n">template</span> <span class="o">=</span> <span class="n">TemplateSynthesis</span><span class="p">(</span>
    <span class="n">freq_ar</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># load the pre-defined template from before</span>
<span class="n">template</span><span class="o">.</span><span class="n">load_template</span><span class="p">(</span><span class="s2">&quot;some_template.hdf5&quot;</span><span class="p">,</span> <span class="n">save_dir</span><span class="o">=</span><span class="s2">&quot;/path/to/templates&quot;</span><span class="p">)</span>

<span class="c1"># define an arbitrary shower as before</span>
<span class="n">shower</span> <span class="o">=</span> <span class="n">Shower</span><span class="p">()</span>
<span class="n">shower</span><span class="o">.</span><span class="n">set_parameters</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">grammages</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
<span class="c1"># set the longitudinal profile</span>
<span class="n">long_profile</span> <span class="o">=</span> <span class="n">some_longitudinal_profile_function</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">grammages</span><span class="p">)</span>
<span class="n">shower</span><span class="o">.</span><span class="n">set_longitudinal_profile</span><span class="p">(</span><span class="n">long_profile</span><span class="p">)</span>

<span class="c1"># OR: use a simulated shower</span>
<span class="n">shower</span> <span class="o">=</span> <span class="n">CoreasShower</span><span class="p">(</span><span class="s2">&quot;path/to/simulation/file.hdf5&quot;</span><span class="p">)</span>
<span class="c1"># transform the profile to the origin shower</span>
<span class="c1"># pass in the grammage from the origin shower</span>
<span class="n">shower</span><span class="o">.</span><span class="n">transform_profile_to_origin</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">grammages</span><span class="p">)</span>

<span class="c1"># map the template to the shower</span>
<span class="n">mapped_traces</span> <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">map_template</span><span class="p">(</span><span class="n">shower</span><span class="p">)</span>
</code></pre></div>
</div>
<p>The mapped traces will return the electric field traces for all antennas in the shower,
which can be used for further analysis.</p>







  
  






                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2025, Mitja Desmet, Keito Watanabe.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    8.2.3.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
      
        <script src="../_static/sphinx_immaterial_theme.32136f45f91ae6956.min.js?v=a7a9472a"></script>
        <script src="/_static/language_data.js"></script>
        <script src="/_static/documentation_options.js"></script>
        <script src="/_static/sphinx_immaterial_theme.32136f45f91ae6956.min.js"></script>
    
  </body>
</html>